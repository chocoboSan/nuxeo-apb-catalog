FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBudXhlby1hcmVuZGVyLXJlbmRpdGlvbi1hcGIKZGVzY3Jp\
cHRpb246IEFSZW5kZXIgUmVuZGl0aW9uIGRlcGxveW1lbnQgaW4gT3BlbnNoaWZ0IGZvciBOdXhl\
bwpiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwKdGFnczoKICAtIG51eGVvCiAgLSBudXhl\
by1hcmVuZGVyLXJlbmRpdGlvbgptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQVJlbmRlciBSZW5k\
aXRpb24gZW52aXJvbm1lbnQgZm9yIE51eGVvCiAgaW1hZ2VVcmw6ICJodHRwczovL3d3dy5udXhl\
by5jb20vYXNzZXRzL2ltZ3MvbG9nbzM0MHg2MC5wbmciCiAgbG9uZ0Rlc2NyaXB0aW9uOgogICAg\
VGhpcyBEZXBsb3lzIGFuIEFSZW5kZXIgUmVuZGl0aW9uIGVudmlyb25tZW50IHRoYXQgY2FuIGJl\
IHVzZWQgd2l0aCBOdXhlbwogIGRlcGVuZGVuY2llczogW10KICBwcm92aWRlckRpc3BsYXlOYW1l\
OiAiTnV4ZW8iCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlZmF1\
bHQgQVJlbmRlciBSZW5kaXRpb24gZGVwbG95bWVudAogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRh\
dGE6IHt9CiAgICBwYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBwcm9qZWN0X25hbWUKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIHRpdGxlOiBQcm9qZWN0IE5hbWUKICAgICAgZGVmYXVsdDogYXJlbmRl\
cgogICAgICBkaXNwbGF5X2dyb3VwOiBQcm9qZWN0IHByb3BlcnRpZXMKCiAgICAtIG5hbWU6IGFy\
ZW5kZXJfcmVuZGl0aW9uX2ltYWdlX3JlZ2lzdHJ5CiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0\
aXRsZTogQVJlbmRlciByZW5kaXRpb24gaW1hZ2UKICAgICAgZGVmYXVsdDogZG9ja2VyLXJlZ2lz\
dHJ5LmRlZmF1bHQuc3ZjOjUwMDAvY29tbW9uLWluZnJhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENv\
bnRhaW5lciBJbWFnZQogICAgLSBuYW1lOiBhcmVuZGVyX3JlbmRpdGlvbl9pbWFnZV92ZXJzaW9u\
CiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogQVJlbmRlciByZW5kaXRpb24gaW1hZ2UK\
ICAgICAgZGVmYXVsdDogIjQuMC42Lk5YMi4wIgogICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWlu\
ZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25faW1hZ2VfcHVsbF9leGlzdGlu\
Z19zZWNyZXQKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBOYW1lIG9mIHNlY3JldCB0\
byB1c2UgdG8gcHVsbCBpbWFnZSAoTGVhdmUgZW1wdHkgaWYgeW91dCB3YW50IHRvIHVzZSB1c2Vy\
L3Bhc3N3b3JkKQogICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFt\
ZTogYXJlbmRlcl9yZW5kaXRpb25faW1hZ2VfcHVsbF91c2VybmFtZQogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgdGl0bGU6IFVzZXJuYW1lIHRvIHVzZSB0byBwdWxsIHRoZSBEb2NrZXIgaW1hZ2UK\
ICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCiAgICAtIG5hbWU6IGFyZW5kZXJf\
cmVuZGl0aW9uX2ltYWdlX3B1bGxfcGFzc3dvcmQKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRp\
dGxlOiBQYXNzd29yZCB0byB1c2UgdG8gcHVsbCB0aGUgRG9ja2VyIGltYWdlCiAgICAgIGRpc3Bs\
YXlfdHlwZTogcGFzc3dvcmQKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCgog\
ICAgLSBuYW1lOiBhcmVuZGVyX2F1dG9zY2FsaW5nX21pbgogICAgICBkZWZhdWx0OiAxCiAgICAg\
IHR5cGU6IG51bWJlcgogICAgICB0aXRsZTogQXV0b3NjYWxpbmcgTWluaW11bSByZXBsaWNhcwog\
ICAgICBkaXNwbGF5X2dyb3VwOiBBdXRvc2NhbGluZwogICAgLSBuYW1lOiBhcmVuZGVyX2F1dG9z\
Y2FsaW5nX21heAogICAgICBkZWZhdWx0OiAxMAogICAgICB0eXBlOiBudW1iZXIKICAgICAgdGl0\
bGU6IEF1dG9zY2FsaW5nIE1heGltdW0gcmVwbGljYXMKICAgICAgZGlzcGxheV9ncm91cDogQXV0\
b3NjYWxpbmcKICAgIC0gbmFtZTogYXJlbmRlcl9hdXRvc2NhbGluZ190YXJnZXRDUFUKICAgICAg\
ZGVmYXVsdDogODAKICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBBdXRvc2NhbGluZyBU\
YXJnZXQgQ1BVIFVzYWdlIHBlcmNlbnRhZ2UKICAgICAgZGlzcGxheV9ncm91cDogQXV0b3NjYWxp\
bmcKCiAgICAtIG5hbWU6IGFyZW5kZXJfYnJva2VyX3Jlc291cmNlcwogICAgICBkZWZhdWx0OiAn\
eyJsaW1pdHMiOiB7ImNwdSI6ICIxIiwibWVtb3J5IjogIjEuNUdpIn0sInJlcXVlc3RzIjogeyJj\
cHUiOiAiMSIsIm1lbW9yeSI6ICIxR2kifX0nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogQnJva2VyIFBvZCByZXNvdXJjZSByZXF1ZXN0cyBhbmQgbGltaXRzCiAgICAgIGRpc3BsYXlf\
dHlwZTogdGV4dGFyZWEKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNwZWNzCiAgICAt\
IG5hbWU6IGFyZW5kZXJfY29udmVydGVyX3Jlc291cmNlcwogICAgICBkZWZhdWx0OiAneyJsaW1p\
dHMiOiB7ImNwdSI6ICIxLjUiLCJtZW1vcnkiOiAiNkdpIn0sInJlcXVlc3RzIjogeyJjcHUiOiAi\
MSIsIm1lbW9yeSI6ICI0R2kifX0nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogQ29u\
dmVydGVyIFBvZCByZXNvdXJjZSByZXF1ZXN0cyBhbmQgbGltaXRzCiAgICAgIGRpc3BsYXlfdHlw\
ZTogdGV4dGFyZWEKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNwZWNzCiAgICAtIG5h\
bWU6IGFyZW5kZXJfcGRmYm94X3Jlc291cmNlcwogICAgICBkZWZhdWx0OiAneyJsaW1pdHMiOiB7\
ImNwdSI6ICIxIiwibWVtb3J5IjogIjEuNUdpIn0sInJlcXVlc3RzIjogeyJjcHUiOiAiMSIsIm1l\
bW9yeSI6ICIxR2kifX0nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogUERGQm94IFBv\
ZCByZXNvdXJjZSByZXF1ZXN0cyBhbmQgbGltaXRzCiAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFy\
ZWEKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNwZWNzCiAgICAtIG5hbWU6IGFyZW5k\
ZXJfam5pX3Jlc291cmNlcwogICAgICBkZWZhdWx0OiAneyJsaW1pdHMiOiB7ImNwdSI6ICIyIiwi\
bWVtb3J5IjogIjZHaSJ9LCJyZXF1ZXN0cyI6IHsiY3B1IjogIjIiLCJtZW1vcnkiOiAiNEdpIn19\
JwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEpOSSBQb2QgcmVzb3VyY2UgcmVxdWVz\
dHMgYW5kIGxpbWl0cwogICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRpc3BsYXlf\
Z3JvdXA6IENvbnRhaW5lciBTcGVjcwogICAgLSBuYW1lOiBhcmVuZGVyX2Rmc19yZXNvdXJjZXMK\
ICAgICAgZGVmYXVsdDogJ3sibGltaXRzIjogeyJjcHUiOiAiMSIsIm1lbW9yeSI6ICIxLjVHaSJ9\
LCJyZXF1ZXN0cyI6IHsiY3B1IjogIjEiLCJtZW1vcnkiOiAiMUdpIn19JwogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgdGl0bGU6IERGUyBQb2QgcmVzb3VyY2UgcmVxdWVzdHMgYW5kIGxpbWl0cwog\
ICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5l\
ciBTcGVjcwogICAgLSBuYW1lOiBwZXJzaXN0ZW50Vm9sdW1lX3N0b3JhZ2VDbGFzcwogICAgICBk\
ZWZhdWx0OiAnc2hhcmVkJwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFN0b3JhZ2Ug\
Y2xhc3NlIG5hbWUgKG11c3QgYmUgY2FwYWJsZSBvZiBSV1gpCiAgICAgIGRpc3BsYXlfZ3JvdXA6\
IENvbnRhaW5lciBTcGVjcwoKICAgIC0gbmFtZTogYXJlbmRlcl9kZWJ1Z19wb2QKICAgICAgZGVm\
YXVsdDogZmFsc2UKICAgICAgdHlwZTogYm9vbGVhbgogICAgICBkaXNwbGF5X3R5cGU6IGNoZWNr\
Ym94CiAgICAgIHRpdGxlOiBEZXBsb3kgYSBkZWJ1ZyBwb2QKICAgICAgZGlzcGxheV9ncm91cDog\
T3RoZXJzCgogICAgLSBuYW1lOiBhcmVuZGVyX3JlbmRpdGlvbl9pbWFnZW1hZ2lja19vcHRpb25z\
CiAgICAgIGRlZmF1bHQ6ICctcXVhbGl0eSwxMDAsLWRlbnNpdHksNzJ4NzIsLXVuaXRzLFBpeGVs\
c1BlckluY2gsLWF1dG8tb3JpZW50LCtyZXBhZ2UnCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0\
aXRsZTogT3B0aW9ucyBwYXNzZWQgdG8gSW1hZ2UgTWFnaWNrIGZvciBjb252ZXJzaW9ucwogICAg\
ICBkaXNwbGF5X2dyb3VwOiBBUmVuZGVyIGNvbmZpZ3VyYXRpb24KCiAgICAtIG5hbWU6IGFyZW5k\
ZXJfcmVuZGl0aW9uX2NvbnZlcnNpb25fdGltZW91dAogICAgICBkZWZhdWx0OiAyNDAKICAgICAg\
dHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBUaW1lb3V0IGZvciBjb252ZXJzaW9uCiAgICAgIGRp\
c3BsYXlfZ3JvdXA6IEFSZW5kZXIgY29uZmlndXJhdGlvbgoKICAgIC0gbmFtZTogYXJlbmRlcl9y\
ZW5kaXRpb25fbW9uaXRvcmluZ19lbmFibGVkCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgICAgdHlw\
ZTogYm9vbGVhbgogICAgICBkaXNwbGF5X3R5cGU6IGNoZWNrYm94CiAgICAgIHRpdGxlOiBFbmFi\
bGUgTW9uaXRvcmluZyBzdGFjawogICAgICBkaXNwbGF5X2dyb3VwOiBNb25pdG9yaW5nCgogICAg\
LSBuYW1lOiBhcmVuZGVyX3JlbmRpdGlvbl9tb25pdG9yaW5nX2VzX3NlcnZpY2UKICAgICAgZGVm\
YXVsdDogYXJlbmRlci1tb25pdG9yLWVsYXN0aWNzZWFyY2gKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBFUyBzZXJ2aWNlIGluc3RhbmNlCiAgICAgIGRpc3BsYXlf\
Z3JvdXA6IE1vbml0b3JpbmcKCiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX21vbml0b3Jp\
bmdfa2liYW5hX3NlcnZpY2UKICAgICAgZGVmYXVsdDogYXJlbmRlci1tb25pdG9yLWtpYmFuYQog\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IE5hbWUgb2YgdGhlIEtpYmFuYSBzZXJ2aWNl\
IGluc3RhbmNlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IE1vbml0b3JpbmcKCg=="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-arender-apb/
ADD . /opt/ansible/roles/nuxeo-arender-rendition-apb/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb