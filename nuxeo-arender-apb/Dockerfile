FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG51eGVvLWFyZW5kZXItYXBiCmRlc2NyaXB0aW9uOiBBUmVuZGVy\
IGRlcGxveW1lbnQgaW4gT3BlbnNoaWZ0IGZvciBOdXhlbwpiaW5kYWJsZTogVHJ1ZQphc3luYzog\
b3B0aW9uYWwKdGFnczoKICAtIG51eGVvCiAgLSBhcmVuZGVyCm1ldGFkYXRhOgogIGRpc3BsYXlO\
YW1lOiBBUmVuZGVyIGVudmlyb25tZW50IGZvciBOdXhlbwogIGltYWdlVXJsOiAiaHR0cHM6Ly93\
d3cubnV4ZW8uY29tL2Fzc2V0cy9pbWdzL2xvZ28zNDB4NjAucG5nIgogIGxvbmdEZXNjcmlwdGlv\
bjoKICAgIFRoaXMgRGVwbG95cyBhbiBBUmVuZGVyIGVudmlyb25tZW50IHRoYXQgY2FuIGJlIHVz\
ZWQgd2l0aCBOdXhlbwogIGRlcGVuZGVuY2llczogW10KICBwcm92aWRlckRpc3BsYXlOYW1lOiAi\
TnV4ZW8iCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlZmF1bHQg\
QVJlbmRlciBkZXBsb3ltZW50CiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToge30KICAgIHBh\
cmFtZXRlcnM6CiAgICAtIG5hbWU6IHByb2plY3RfbmFtZQogICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgdGl0bGU6IFByb2plY3QgTmFtZQogICAgICBkZWZhdWx0OiBhcmVuZGVyCiAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IFByb2plY3QgcHJvcGVydGllcwogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdl\
cl9pbWFnZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEFSZW5kZXIgcHJldmlld2Vy\
IGltYWdlCiAgICAgIGRlZmF1bHQ6IGRvY2tlci1yZWdpc3RyeS5kZWZhdWx0LnN2Yzo1MDAwL2Nv\
bW1vbi1pbmZyYS9hcmVuZGVyLXByZXZpZXdlcgogICAgICBkaXNwbGF5X2dyb3VwOiBQcm9qZWN0\
IHByb3BlcnRpZXMKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25faW1hZ2UKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIHRpdGxlOiBBUmVuZGVyIHJlbmRpdGlvbiBpbWFnZQogICAgICBkZWZh\
dWx0OiBkb2NrZXItcmVnaXN0cnkuZGVmYXVsdC5zdmM6NTAwMC9jb21tb24taW5mcmEvYXJlbmRl\
ci1yZW5kaXRpb24KICAgICAgZGlzcGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCiAgICAt\
IG5hbWU6IGFyZW5kZXJfaW1hZ2VfdmVyc2lvbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IEltYWdlIHZlcnNpb24KICAgICAgZGVmYXVsdDogIjEuMC4xIgogICAgICBkaXNwbGF5X2dy\
b3VwOiBQcm9qZWN0IHByb3BlcnRpZXMKCg=="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-arender-apb/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb