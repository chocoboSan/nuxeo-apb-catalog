version: 1.0
name: nuxeo-mongo-apb
description: Mongo deployment for Nuxeo
bindable: True
async: optional
tags:
  - database
  - mongodb
  - nuxeo
metadata:
  displayName: MongoDB for Nuxeo (APB)
  longDescription: An apb that deploys MongoDB for Nuxeo
  providerDisplayName: "Nuxeo"
  console.openshift.io/iconClass: icon-mongodb
plans:
  - name: default
    description: Default
    free: true
    metadata:
      displayName: Default
      longDescription:
        This plan provides a MongoDB replicaset deployment
      cost: $0.00
    parameters:
      - name: NUXEO_BACKINGS_NAME
        title: The name of the backings stack.
        required: true
        default: "nuxeo-backings"
        type: string
      - name: MONGODB_REPLICAS_NUMBER
        title: Number of replicas.
        required: true
        default: 3
        enum: [1, 3, 5, 7]
        type: integer
      - name: MONGODB_REPLICASET_NAME
        title: MongoDB Replicaset name.
        required: true
        default: "rs0"
        type: string
      - name: IMAGE_REPOSITORY
        title: The image repository        
        default: mongo
        type: string
        required: true
      - name: IMAGE_TAG
        title: The image tag
        default: "3.4"
        type: string
        required: true
      - name: MONGODB_STORAGE_SIZE
        title: MongoDB Storage size. 
        default: 10Gi
        type: string
        required: true
      - name: MONGODB_STORAGE_CLASS
        title: MongoDB Storage class.         
        default: aws-fast
        type: string
        required: true
    # updates_to:
    #   - secured
  - name: secured
    description: Secured
    free: true
    metadata:
      displayName: Default
      longDescription:
        This plan provides a MongoDB replicaset deployment with encryption and authentication.
      cost: $0.00
    parameters:
      - name: NUXEO_BACKINGS_NAME
        title: The name of the backings stack.
        required: true
        default: "nuxeo-backings"
        type: string
      - name: MONGODB_REPLICAS_NUMBER
        title: Number of replicas.
        required: true
        default: 3
        enum: [1, 3, 5, 7]
        type: integer
      - name: MONGODB_REPLICASET_NAME
        title: MongoDB Replicaset name.
        required: true
        default: "rs0"
        type: string
      - name: MONGODB_ADMIN_USER
        title: MongoDB Admin user.        
        required: true
        default: admin
        type: string
      - name: MONGODB_ADMIN_PASSWORD
        title: MongoDB Admin password.        
        required: true
        default: password
        type: string      
      - name: IMAGE_REPOSITORY
        title: The image repository        
        default: mongo
        type: string
        required: true
      - name: IMAGE_TAG
        title: The image tag
        default: "3.4"
        type: string
        required: true
      - name: MONGODB_STORAGE_SIZE
        title: MongoDB Storage size. 
        default: 10Gi
        type: string
        required: true
      - name: MONGODB_STORAGE_CLASS
        title: MongoDB Storage class.         
        default: aws-fast
        type: string
        required: true
  #   updates_to:
  #     - secured
  