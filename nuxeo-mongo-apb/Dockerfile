FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG51eGVvLW1vbmdvLWFwYgpkZXNjcmlwdGlvbjogTW9uZ28gZGVw\
bG95bWVudCBmb3IgTnV4ZW8KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFsCnRhZ3M6CiAg\
LSBkYXRhYmFzZQogIC0gbW9uZ29kYgogIC0gbnV4ZW8KbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6\
IE1vbmdvREIgZm9yIE51eGVvIChBUEIpCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBk\
ZXBsb3lzIE1vbmdvREIgZm9yIE51eGVvCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIk51eGVvIgog\
IGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1tb25nb2RiCnBsYW5zOgogIC0g\
bmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlZmF1bHQKICAgIGZyZWU6IHRydWUKICAg\
IG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRp\
b246CiAgICAgICAgVGhpcyBwbGFuIHByb3ZpZGVzIGEgTW9uZ29EQiByZXBsaWNhc2V0IGRlcGxv\
eW1lbnQKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogTlVY\
RU9fQkFDS0lOR1NfTkFNRQogICAgICAgIHRpdGxlOiBUaGUgbmFtZSBvZiB0aGUgYmFja2luZ3Mg\
c3RhY2suCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiAibnV4ZW8tYmFj\
a2luZ3MiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgIC0gbmFtZTogTU9OR09EQl9SRVBMSUNB\
U19OVU1CRVIKICAgICAgICB0aXRsZTogTnVtYmVyIG9mIHJlcGxpY2FzLgogICAgICAgIHJlcXVp\
cmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMwogICAgICAgIGVudW06IFsxLCAzLCA1LCA3XQog\
ICAgICAgIHR5cGU6IGludGVnZXIKICAgICAgLSBuYW1lOiBNT05HT0RCX1JFUExJQ0FTRVRfTkFN\
RQogICAgICAgIHRpdGxlOiBNb25nb0RCIFJlcGxpY2FzZXQgbmFtZS4KICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6ICJyczAiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
IC0gbmFtZTogSU1BR0VfUkVQT1NJVE9SWQogICAgICAgIHRpdGxlOiBUaGUgaW1hZ2UgcmVwb3Np\
dG9yeSAgICAgICAgCiAgICAgICAgZGVmYXVsdDogbW9uZ28KICAgICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IElNQUdFX1RBRwogICAgICAgIHRp\
dGxlOiBUaGUgaW1hZ2UgdGFnCiAgICAgICAgZGVmYXVsdDogIjMuNCIKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IE1PTkdPREJfU1RPUkFH\
RV9TSVpFCiAgICAgICAgdGl0bGU6IE1vbmdvREIgU3RvcmFnZSBzaXplLiAKICAgICAgICBkZWZh\
dWx0OiAxMEdpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgLSBuYW1lOiBNT05HT0RCX1NUT1JBR0VfQ0xBU1MKICAgICAgICB0aXRsZTogTW9uZ29EQiBT\
dG9yYWdlIGNsYXNzLiAgICAgICAgIAogICAgICAgIGRlZmF1bHQ6IGF3cy1mYXN0CiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICMgdXBkYXRlc190bzoKICAg\
ICMgICAtIHNlY3VyZWQKICAtIG5hbWU6IHNlY3VyZWQKICAgIGRlc2NyaXB0aW9uOiBTZWN1cmVk\
CiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERlZmF1bHQK\
ICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRoaXMgcGxhbiBwcm92aWRlcyBhIE1vbmdv\
REIgcmVwbGljYXNldCBkZXBsb3ltZW50IHdpdGggZW5jcnlwdGlvbiBhbmQgYXV0aGVudGljYXRp\
b24uCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IE5VWEVP\
X0JBQ0tJTkdTX05BTUUKICAgICAgICB0aXRsZTogVGhlIG5hbWUgb2YgdGhlIGJhY2tpbmdzIHN0\
YWNrLgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogIm51eGVvLWJhY2tp\
bmdzIgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6IE1PTkdPREJfUkVQTElDQVNf\
TlVNQkVSCiAgICAgICAgdGl0bGU6IE51bWJlciBvZiByZXBsaWNhcy4KICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDMKICAgICAgICBlbnVtOiBbMSwgMywgNSwgN10KICAg\
ICAgICB0eXBlOiBpbnRlZ2VyCiAgICAgIC0gbmFtZTogTU9OR09EQl9SRVBMSUNBU0VUX05BTUUK\
ICAgICAgICB0aXRsZTogTW9uZ29EQiBSZXBsaWNhc2V0IG5hbWUuCiAgICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgICBkZWZhdWx0OiAicnMwIgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAt\
IG5hbWU6IE1PTkdPREJfQURNSU5fVVNFUgogICAgICAgIHRpdGxlOiBNb25nb0RCIEFkbWluIHVz\
ZXIuICAgICAgICAKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGFkbWlu\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgIC0gbmFtZTogTU9OR09EQl9BRE1JTl9QQVNTV09S\
RAogICAgICAgIHRpdGxlOiBNb25nb0RCIEFkbWluIHBhc3N3b3JkLiAgICAgICAgCiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBwYXNzd29yZAogICAgICAgIHR5cGU6IHN0\
cmluZyAgICAgIAogICAgICAtIG5hbWU6IElNQUdFX1JFUE9TSVRPUlkKICAgICAgICB0aXRsZTog\
VGhlIGltYWdlIHJlcG9zaXRvcnkgICAgICAgIAogICAgICAgIGRlZmF1bHQ6IG1vbmdvCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBJTUFH\
RV9UQUcKICAgICAgICB0aXRsZTogVGhlIGltYWdlIHRhZwogICAgICAgIGRlZmF1bHQ6ICIzLjQi\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1l\
OiBNT05HT0RCX1NUT1JBR0VfU0laRQogICAgICAgIHRpdGxlOiBNb25nb0RCIFN0b3JhZ2Ugc2l6\
ZS4gCiAgICAgICAgZGVmYXVsdDogMTBHaQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogTU9OR09EQl9TVE9SQUdFX0NMQVNTCiAgICAgICAg\
dGl0bGU6IE1vbmdvREIgU3RvcmFnZSBjbGFzcy4gICAgICAgICAKICAgICAgICBkZWZhdWx0OiBh\
d3MtZmFzdAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgIyAg\
IHVwZGF0ZXNfdG86CiAgIyAgICAgLSBzZWN1cmVkCiAg"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
