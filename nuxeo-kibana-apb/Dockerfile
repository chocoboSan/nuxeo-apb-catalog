FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG51eGVvLWtpYmFuYS1hcGIKZGVzY3JpcHRpb246IEtpYmFuYSBp\
cyBhIGRhdGEgdmlzdWFsaXphdGlvbiBwbHVnaW4gZm9yIEVsYXN0aWNzZWFyY2gKYmluZGFibGU6\
IFRydWUKYXN5bmM6IG9wdGlvbmFsCnRhZ3M6CiAgLSBudXhlbwogIC0ga2liYW5hCm1ldGFkYXRh\
OgogIGRpc3BsYXlOYW1lOiAiTnV4ZW8gS2liYW5hIChBUEIpIgogIGRlcGVuZGVuY2llczogW10K\
ICBpbWFnZVVybDogImh0dHBzOi8vd3d3LmVsYXN0aWMuY28vYXNzZXRzL2JsdDI4MmFlMjQyMGUz\
MmZjMzgvaWNvbi1raWJhbmEtYmIuc3ZnIgogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJOdXhlbyIK\
cGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxv\
eXMgS2liYW5hIHdpdGhvdXQgcGVyc2lzdGVudCBjYWNoZQogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBFcGhlbWVyYWwgaW5zdGFsbGF0aW9uIGJ5IGRlZmF1\
bHQKICAgIGRlZmF1bHQ6IFRydWUKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogYXBwX25h\
bWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBraWJhbmEKICAgICAgICBk\
ZXNjcmlwdGlvbjogS2liYW5hIGFwcGxpY2F0aW9uCiAgICAgICAgdGl0bGU6IEFwcGxpY2F0aW9u\
IG5hbWUKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGtpYmFuYV9tZW1vcnlf\
bGltaXQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiAyNTZNaQogICAgICAg\
IGRlc2NyaXB0aW9uOiBNZW1vcnkgbGltaXQgZm9yIEtpYmFuYSBjb250YWluZXIKICAgICAgICB0\
aXRsZTogTWVtb3J5IGxpbWl0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBr\
aWJhbmFfaW1hZ2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogS2liYW5hIGlt\
YWdlCiAgICAgICAgZGVmYXVsdDogZG9ja2VyLmVsYXN0aWMuY28va2liYW5hL2tpYmFuYS1vc3MK\
ICAgICAgLSBuYW1lOiBraWJhbmFfaW1hZ2VfdmVyc2lvbgogICAgICAgIHRpdGxlOiBWZXJzaW9u\
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiA3LjYuMQogICAgICAgIHR5\
cGU6IGVudW0KICAgICAgICBlbnVtOiBbIjcuNi4xIiwgNi4zLjIiLCAiNS42LjkiXQogICAgICAt\
IG5hbWU6IGtpYmFuYV9zdG9yYWdlX3BsYW4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0\
aXRsZTogZXBoZW1lcmFsIG9yIHBlcnNpc3RlbnQKICAgICAgICBkZXNjcmlwdGlvbjogVGFrZSB0\
aGUgZGVmYXVsdCBvcHRpb24gZXBoZW1lcmFsIHN0b3JhZ2Ugb3IgY2hvb3NlIHBlcnNpc3RlbnQK\
ICAgICAgICBkZWZhdWx0OiBlcGhlbWVyYWwKICAgICAgLSBuYW1lOiBlbGFzdGljc2VhcmNoX2xh\
YmVsX3NlbGVjdG9yCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogY29tcG9u\
ZW50PWVsYXN0aWNzZWFyY2gKICAgICAgICB0aXRsZTogRVMgTGFiZWwgc2VsZWN0b3IKICAgICAg\
ICBkZXNjcmlwdGlvbjogTGFiZWwgc2VsZWN0b3IgdG8gdXNlIGluIG9yZGVyIHRvIGZpbmQgdGhl\
IEVsYXN0aWNzZWFyY2ggc2VydmljZQogICAgICAtIG5hbWU6IGtpYmFuYV9zZWN1cmUKICAgICAg\
ICB0eXBlOiBib29sZWFuCiAgICAgICAgZGVmYXVsdDogdHJ1ZQogICAgICAgIGRlc2NyaXB0aW9u\
OiBBbGxvdyBhY2Nlc3Mgb25seSB0byBPcGVuU2hpZnQgdXNlcnMgaGF2aW5nIGFjY2VzcyB0byB0\
aGUgc2VydmljZQogICAgICAgIHRpdGxlOiBTZWN1cmVkIGFjY2Vzcwo="

COPY playbooks /opt/apb/actions
# Add our role into the ansible roles dir
COPY roles /opt/ansible/roles/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
